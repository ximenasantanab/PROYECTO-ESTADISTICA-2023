---
title: "R Notebook"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

#                                 

#                                 PROYECTO 

CURSO : ESTADÍSTICA - "ANÁLISIS DESCRIPTIVO"

**Integrantes Grupo 6 :**

| Nombre y Apellido |  Código   | Participación |
|:-----------------:|:---------:|:-------------:|
|  Ximena Santana   | 202010024 |      0%       |
|                   |           |               |

1.  **Tema**

    Análisis del servicio de alojamiento de Airbnb en nueve ciudades en Europa del 2023.

2.  **Objetivo general**

    Analizar del servicio de alojamiento de Airbnb en nueve ciudades en Europa del 2023.

3.  **Objetivos específicos**

    -   Analizar las ciudades con mejor ranking de experiencia de Airbnb en Europa del 2023.

    -   Describir las características de los alojamientos más caros y más económicos en ciudades de Europa. del 2023.

    -   Analizar la atracción de un Airbnb y su relación con su ubicación en ciudades de Europa del 2023.

4.  **Planificación : realizar un diagrama de Gantt hasta la semana 15. (FALTA)**

    Para validar la factibilidad del proyecto en el tiempo de 16 semanas, se realizó un diagrama de Gantt con las actividades a realizarse y sus tiempos límite.

5.  **Instrumento de recolección**

    Acceso a data de fuente secundaria ( 41 mil 714 observaciones: Datos sobre los AIRBNB de 9 ciudades famosas de Europa, Amsterdam, Athens, Barcelona, Berlin, Budapest, Lisbon, Paris, Rome and Vienna. ) *Población : \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ Muestra : \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ .*

    <https://www.kaggle.com/datasets/dipeshkhemani/airbnb-cleaned-europe-dataset?group=bookmarked>

    <https://drive.google.com/file/d/1I1u893jIu2HbdGp-ljNbc6_ANqmrJ2Xq/view?usp=share_link>

6.  **Clasificación de variables**

    | N°  |          Variable           |         Tipo         |
    |:---:|:---------------------------:|:--------------------:|
    |  1  |            City             | (Categórica nominal) |
    |  2  |     Cuándo lo reservan      | (Categórica nominal) |
    |  3  |          Room Type          | (Categórica nominal) |
    |  4  |         Shared Room         | (Categórica nominal) |
    |  5  |        Private Room         | (Categórica nominal) |
    |  6  |          Superhost          | (Categórica nominal) |
    |  7  |       Multiple Rooms        | (Categórica nominal) |
    |  8  |     Cleanliness Rating      | (Categórica ordinal) |
    |  9  |     Guest Satisfaction      | (Categórica ordinal) |
    | 10  |     Business (ofertas)      | (Categórica nominal) |
    | 11  |       Person Capacity       | (Numérica discreta)  |
    | 12  |            Price            | (Numérica continua)  |
    | 13  |          Bedrooms           | (Numérica discreta)  |
    | 14  |      City Center (km)       | (Numérica continua)  |
    | 15  |     Metro Distance (km)     | (Numérica continua)  |
    | 16  | Normalised attraction Index | (Numérica continua)  |
    | 17  | Normalised restaurant index | (Numérica continua)  |

7.  **Lectura de base de datos**

-   Carga de Librerías y funciones :

    ```{r}
    library(readr)
    library(dplyr)
    D <- read_csv("Aemf1.csv") #EL ARCHIVO Aemf1 y datos.AIRBNB es lo mismo. 
    ```

-   Lectura de variables

    ```{r}
    summary(D)
    View(D) 
    ```

-   Eliminamos la columna 18 y 16, ya que de las 2 variantes de las variables Attraction y Restaurant , sólo usamos sus valores normalizados.

```{r}
D$`Attraction Index` <- NULL
D$`Restraunt Index` <- NULL

```

-   Reasignación de nombres en "D2":

    ```{r}
    names(D)
    ```

```{r}
D %>% rename( Tipo = `Room Type` , Capacidad = `Person Capacity`, Oferta = Business, Habitaciones = Bedrooms, Ind.Atraccion = `Normalised Attraction Index`, Precio = Price, Share_Room = `Shared Room`, Limpieza = `Cleanliness Rating`, Ind.Restaurantes = `Normalised Restraunt Index`, Satisfaccion = `Guest Satisfaction`, Ciudad = City, Private_Room = `Private Room` ) -> D2

```

```{r}
names(D2)
```

-   Número de Observaciones y Variables "D2"

    ```{r}
    'Total de observaciones'
    nrow(D2)
    'Total de variables'
    ncol(D2)
    ```

-   Búsqueda de NA's y comprobación de casos completos

    ```{r}

    Total_de_NAs <- sum(is.na(D))
    print(paste("El total de NAs es :", Total_de_NAs)) 

    Observaciones_completas <- sum(complete.cases(D2))
    print(paste("Observaciones completas es : ",Observaciones_completas ))
    Observaciones_incompletas <- sum(!complete.cases(D2))
    print(paste("Observaciones incompletas es : ", Observaciones_incompletas))
    ```

## Limpieza de Datos

El primer paso para la limpieza de datos es hacer un resumen de los datos que se tienen.

```{r}
summary(D2)
```

En primer lugar, se observa que Multiple rooms tiene como valor mínimo 0 y como valor máximo 1; esto mismo ocurre en el caso de la variable Oferta. Procedemos a analizar qué valores se encuentran dentro de estas dos variables.

```{r}
par(mfrow=c(1,2))

counts <- table(D2$`Multiple Rooms`)
counts
barplot(counts, main = "Multiple Rooms", ylab = "Número de Observaciones", xlab = "Valores" , ylim = c(0,35000))


```

```{r}
counts <- table(D2$Oferta)
barplot(counts, main = "Oferta", ylab = "Número de Observaciones", xlab = "Valores" , ylim = c(0,30000))
```

Como se observa, ambas variables cuentan solamente con "0" y "1" como valores, por lo que se trata de variables booleanas (0 y 1). Se observa que, además de estas dos variables, se tiene que Share_Room, Private_Room y Superhost también son variables de tipo bool. Para facilitar las operaciones futuras, se procederá a cambiar los "0" y "False" a la cadena "No", y los "1" y "True" a la cadena "Sí".

```{r}
vec <- factor(D2$Oferta, labels = c('No','Sí'))
D2$Oferta <- vec
vec <- factor(D2$`Multiple Rooms`, labels = c('No','Sí'))
D2$`Multiple Rooms` <- vec
vec <- factor(D2$Share_Room, labels = c('No','Sí'))
D2$Share_Room <- vec
vec <- factor(D2$Private_Room, labels = c('No','Sí'))
D2$Private_Room <- vec
vec <- factor(D2$Superhost, labels = c('No','Sí'))
D2$Superhost <- vec
```

A continuación, se hace nuevamente un resumen para verificar los cambios realizados a las variables.

```{r}
summary(D2)
```

#### Verificar valores enteros :

-    Valores Normalizados : De este resumen, también se puede observar que el Indice de Atracción normalizado y el Índice de Restaurantes normalizado se encuentran dentro del rango establecido (0-100).

-   Variable Capacidad y Habitaciones : A continuación se verificará que la variable capacidad contenga solamente números enteros, ya que un airbnb no puede tener capacidad para un número no entero de personas. El mismo análisis se realizará para la variable Habitaciones, ya que sucede lo mismo con esta variable.

    ```{r}
    par(mfrow=c(1,2))
    counts <- table(D2$Capacidad)
    barplot(counts, main = "Capacidad", ylab = "Número de Observaciones", xlab = "Valores" , ylim = c(0,20000))


    counts <- table(D2$Habitaciones)
    barplot(counts, main = "Habitaciones", ylab = "Número de Observaciones", xlab = "Valores" , ylim = c(0,30000))

    ```

    ```{r}
    "Sólo valores enteros de habitaciones y Capacidad de personas"
    unique(D2$Habitaciones)
    unique(D2$Capacidad)
    ```

Se observa que ambas variables cumplen con los criterios previamente mencionados.

#### Verificando variable Ciudad, Día y Tipo :

Por último se procederá a analizar la variable Ciudad, Día y Tipo; estas son catalogadas por R como variables de tipo "character".

-   Ciudad : Para el caso, de la variable Ciudad, deberían haber 9 valores distintos, que representen las 9 ciudades a las que pertenece la data.

    ```{r}
    unique(D2$Ciudad)

    # GRÁFICA DE CIUDADES Y NÚMERO DE OBSERVACIONES
    counts <- table(D2$Ciudad)
    barplot(counts, main = "Ciudad", ylab = "Número de Observaciones" , las=2, ylim = c(0,10000), cex.names = 0.9)
    ```

Una vez comprobado que solamente existen 9 ciudades en el Dataframe, se procede a revisar el Día y Tipo de airbnb.

```{r}

unique(D2$Day)
unique(D2$Tipo)
par(mfrow=c(1,2)) #QUE HACE mfrow ?
counts <- table(D2$Day)
barplot(counts, main = "Día", ylab = "Número de Observaciones", las = 2, ylim = c(0,25000), cex.axis = 0.8, cex.lab = 0.7, cex.names = 0.6)
counts <- table(D2$Tipo)
barplot(counts, main = "Tipo", ylab = "Número de Observaciones", las = 2, ylim = c(0,30000), cex.axis = 0.8, cex.names = 0.6, cex.lab = 0.7)
```

Se observa que tampoco existen anomalías en estas variables, por lo que podemos concluir que nuestra data se encuentra en condiciones de ser utilizada para los análisis posteriores.

## Análisis Descriptivo 

1.  Objetivo 1: Describir las características de los alojamientos más caros y más económicos.

    Para elaborar nuestro rankine tomamos en cuentas los siguientes parámetros :

2.  Variables numéricas de interés

3.  **Objetivo 2: Describir las características de los alojamientos más caros y más económicos.**

-   Seleccionar los Airbnb más caros de cada Ciudad :

    ```{r}

    ```

-   Seleccionamos la lista de Airbnb de sólo una ciudad y de ellos ubicamos si el que tiene mayor costo se encuentra cerca a la ciudad, cuánta capacidad de personas tiene y si existe una relación con el índice de restaurantes y su cercanía al metro y centro de la cuidad.

    ```{r}
    unique(D2$Ciudad)
    ```

    ### La primera ciudad a analizar es Roma (DR): 

    ```{r}
    D2 %>% filter(Ciudad == "Rome") -> DR
    DR
    ```

```{r}

"Precio más caro en Roma" 
max(DR$Precio)

a <- which.max(DR$Precio)
a

```

```{r}
DR[1758,1:17]
```

```{r}
"Indice de Restaurantes del 0 al 100"
round(DR$Ind.Restaurantes[a],digits = 2)
"Indice de atracción del 0 al 100"
round(DR$Ind.Atraccion[a],digits = 2)
"Distancia al centro de la cuidad en km"
round(DR$`City Center (km)`[a],digits = 2)
"Distancia al metro en km"
round(DR$`Metro Distance (km)`[a],digits = 2)


```

### La segunda ciudad es París

```{r}
D2 %>% filter(Ciudad == "Paris") -> DPARIS
DPARIS
```

```{r}
"Precio más caro en París" 
max(DPARIS$Precio)

a <- which.max(DPARIS$Precio)
a
```

```{r}
DPARIS[2349,1:17]
```

### La segunda ciudad es Amsterdam 

```{r}
D2 %>% filter(Ciudad == "Amsterdam") -> DAMS
DAMS
```

```{r}

"Precio más caro en Amsterdam" 
max(DAMS$Precio)

a <- which.max(DAMS$Precio)
a

```

```{r}
DAMS[1963,1:17]

```

```{r}
regresion3 <- lm(Precio ~ `City Center (km)`, data = DR)
#summary(regresion3)
plot(DR$`City Center (km)`,DR$Precio, xlab='Distancia al centro de la ciudad', ylab='Precio (dólares)')
abline(regresion3)
```

Aquí podemos obervar las características de Airbnb más costoso de cada cuidad, sin embargo esto cambia si este fue en un weekday o un weekend. Por ello se procede a separar los más caros en estos diferentes tipos de días :
